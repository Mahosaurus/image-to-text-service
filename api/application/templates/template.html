<!doctype html>
<head>
    <title>Upload new File</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='styles/styles.css') }}">
</head>
<body>
<script class="jsbin" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<div class="file-upload">
  <button class="file-upload-btn" type="button" onclick="$('.file-upload-input').trigger( 'click' )">Add Image</button>

  <div class="image-upload-wrap">
    <input class="file-upload-input" type='file' onchange="handleFileUpload(this);" accept="image/*" />
    <div class="drag-text">
      <h3>Drag and drop a file or select add Image</h3>
    </div>
  </div>
  <div class="file-upload-content">
    <img class="file-upload-image" src="#" alt="your image" />
    <div class="image-title-wrap">
      <button type="button" onclick="removeUpload()" class="remove-image">Remove <span class="image-title">Uploaded Image</span></button>
    </div>
  </div>
</div>

<script>
  function handleFileUpload(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();
      reader.onload = function(e) {
        $('.file-upload-image').attr('src', e.target.result);
        $('.file-upload-content').show();
        $('.image-upload-wrap').hide();
        uploadForm();
      }
      reader.readAsDataURL(input.files[0]);
    }
  }

  function removeUpload() {
    $('.file-upload-input').val(null);
    $('.file-upload-image').attr('src', '#');
    $('.file-upload-content').hide();
    $('.image-upload-wrap').show();
  }

  function uploadForm() {
    var form = new FormData();
    form.append('file', $('.file-upload-input')[0].files[0]);
    $.ajax({
      url: '{{ url_for('upload_file') }}',
      type: 'POST',
      data: form,
      processData: false,
      contentType: false,
      success: function(response) {
        console.log(response);
      },
      error: function(jqXHR, textStatus, errorThrown) {
        console.error(textStatus, errorThrown);
      }
    });
  }
</script>


</body>
